---
type: daily
date: 2025-09-14
week: 2025-W37
tags: [daily]
---

# 2025-09-14 星期日 Daily

## 今日三件事
- [ ] 1.
- [ ] 2.
- [ ] 3.

## 关键产出
![[c472dd51204cd9d49d33bccd9a16437c.jpg]]
```
E:\git_rep\brand-ocr\data\input\20240914_油站批次1\油站A.jpg
E:\git_rep\brand-ocr\data\input\20240914_1\a.jpg
```
## 遇到问题
- [ ] ```cmd
pip install requests  # 用于调用API
```
pip install json5     # 用于解析JSON规则表
```
```

## 今日任务
```tasks
not done
due today
sort by priority then by due
```

## 逾期任务
```tasks
not done
due before today
sort by due
```
```
	"日期",       # 例如："2025-09-10" 可以源于图片的创建日期
"城市",       # 例如："北京市" 来源于截图地址中的多数曝光城市 比如出现最多的城市名

  "油站名称",       # 例如："中石油加油站"
    "地址",           # 例如："北京市朝阳区XX路XX号"
    "距离",       # 例如："18.02" 单位默认KM，不输出
    "优惠价格",   # 例如："7.58元"  大的字体价格  单位默认元/L，不输出
    "油站价",       # 例如："7.88元"  单位默认元/L，不输出
   
    "营销策略",       # 例如："满200前10升"
     "优惠信息",       # 例如："满200减14" "加200省26"
     
    "是否新站"  # 例如："新站"
```
## 明日关注三件事

API key:
sk-08fd5d0d8d0b43f3a36bc08405c10eb8

sk-d8001069e43f42d6beff06ebe76a3af8

sk-6ad0b54ce0ec4b77bb2592ea1e266e70
sk-f3ded29ed2734526a7b4a76c2323c6c7

sk-b0631b6f894a4489a9d8f844ee8adffd

```cmd
setx TONGYI_API_KEY "sk-d8001069e43f42d6beff06ebe76a3af8"
```
# 今日记录
- 灵感 / 事件 / 任务
```
- git remote add origin git@github.com:wcy8822/git@github.com:wcy8822/my-obsidian-notes.git
```
```
# 设置全局用户名（GitHub 用户名，如 wcy8822） 
git config --global user.name "wcy8822" 
  # 设置全局邮箱（注册GitHub时用的邮箱） 
  git config --global user.email "wcy8822@gmail.com"
```

# 今日总结
一句话总结今天的关键发现。


```python
all_images = collect_images(INPUT_DIR)
pending_images = all_images  # 所有图片都视为待处理，强制重新处理
```
```

 try:

        # 收集所有待处理图片

        all_images = collect_images(INPUT_DIR, RECURSIVE_READ_INPUT)

        total_count = len(all_images)

        logging.info(f"发现图片总数：{total_count}")
```


```
  

def main():

    global batch_cities, temp_process_status

    # 获取批次城市信息

    batch_cities = get_batch_cities()

    # 初始化环境

    init_environment()

    try:

        # 收集所有待处理图片

        all_images = collect_images(INPUT_DIR, RECURSIVE_READ_INPUT)

        total_count = len(all_images)

        logging.info(f"发现图片总数：{total_count}")

        if total_count == 0:

            logging.info("没有待处理的图片，程序将退出")

            return

        # 阶段1：批量处理所有图片数据（不移动文件）

        logging.info("开始批量处理图片数据...")

        for i, image_path in enumerate(all_images, 1):

            logging.info(f"\n处理第{i}/{total_count}张图片：{image_path.name}")

            result = process_single_image(image_path)

            temp_process_status[str(image_path)] = result

            # 每处理5张图片保存一次中间状态

            if i % 5 == 0:

                save_temp_status()

        # 保存最终的中间状态

        save_temp_status()

        # 阶段2：统一移动所有图片

        logging.info("\n开始统一移动图片...")

        for i, (image_path, process_info) in enumerate(temp_process_status.items(), 1):

            image_name = process_info["image_name"]

            status = process_info["overall_status"]

            logging.info(f"移动第{i}/{len(temp_process_status)}张图片：{image_name}")

            processed_path = move_processed_image(image_path, status)

            # 更新处理结果中的图片路径

            for station in process_info["stations"]:

                station["processed_image_path"] = processed_path or ""

        # 阶段3：将结果写入文件

        logging.info("\n开始写入结果文件...")

        write_results_to_files()

        # 统计结果

        success_count = sum(1 for info in temp_process_status.values() if info["overall_status"] == "成功")

        confirm_count = sum(1 for info in temp_process_status.values() if info["overall_status"] == "待确认")

        failed_count = sum(1 for info in temp_process_status.values() if info["overall_status"] == "失败")

        logging.info(f"\n处理完成！总计：{total_count}张")

        logging.info(f"成功：{success_count}张，待确认：{confirm_count}张，失败：{failed_count}张")

        logging.info(f"结果文件路径：{RESULTS_DIR}")

        logging.info(f"待确认文件路径：{TO_CONFIRM_TABLE_DIR}")

    except Exception as e:

        logging.critical(f"程序运行出错：{str(e)}", exc_info=True)

    finally:

        # 最后尝试保存一次中间状态

        save_temp_status()

  
  

if __name__ == "__main__":

    main()
```