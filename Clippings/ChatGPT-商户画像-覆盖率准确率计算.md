---
title: ChatGPT
source: https://chatgpt.com/g/g-p-692abef2079c81918c16c22b66aec849/c/694ac9da-2384-8324-b4b0-64cd25f4e5d2
author:
  - "[[ChatGPT-非油品-2期BRD草稿]]"
published:
created: 2025-12-24
description: ChatGPT 是一款供日常使用的 AI 聊天机器人。与最先进的 AI 模型互动，探索创意、解决问题以及提升学习效率。
tags:
  - clippings
---
到了目标审计的时刻了，我要来计算我的标签覆盖率和准确率；现在我是owner，我要提一个方案；针对我的信息，你给一个成熟的方案建议；

20251224\_1000\_标签覆盖率与准确率审计方案\_V1  
tags：#覆盖率口径 #准确率评估 #QC体系 #抽样审计 #闭环治理

---

## 1）一句话结论

用 **`station_tag_target_value` 作为唯一审计终表** ，以 **“适用范围 × 非兜底 × QC 有意义”** 统一覆盖率口径；准确率用 **“分层抽样 + 证据回溯（audit\_log/trace\_json）+ 人工金标集”** 做可解释评估，并把结果沉淀为 **按 tag\_code 的红黄绿门禁+修复 Runbook** ，你就能以 Owner 身份交付一套“可审、可追、可改、可持续跑”的成熟审计方案。

---

## 2）三段论据（现状与问题 → 关键洞察 → 路径方案）

### 论据一：现状与问题（为什么现在必须做“统一口径”的审计）

- 你现在的标签链路已经具备“终表 + 审计日志 + 快照”三件套：
	- 终表： `station_tag_target_value` ，并且已经内置 QC 字段（是否有意义、是否兜底、是否错误清洗等）。
	- 快照： `store_tag_snapshot_di` （store\_id + as\_of\_date + tag\_code 粒度）。
	- 审计： `tag_audit_log_di` （含 chosen\_level、候选值、trace\_json，可回溯“为什么取这个值”）。
- 真正的风险在于：
	1. 覆盖率若不统一“适用范围/兜底识别/分子条件”，指标会被“默认值填满”虚高；
	2. 准确率若不建立“证据链 + 金标集”，只能靠口头解释，审计时站不住。

### 论据二：关键洞察（审计要抓住两条主线）

- **覆盖率** 不是“有没有值”，而是“在适用范围内，是否产出非兜底且业务有意义的值”。你们已经把兜底与质量拆成了 QC 字段，这就是天然的审计口径锚点。
- **准确率** 不是只报一个数字，而是要回答三件事：
	1. 错在哪里（哪类站、哪类来源、哪类枚举/正则）；
	2. 为什么错（trace\_json/候选值/层级权重导致）；
	3. 怎么修（规则/枚举/映射/上游数据质量/阈值）。 `tag_audit_log_di` 让这件事可落地。

### 论据三：路径方案（给你一套可直接提审的成熟方案）

- 按你们“总控文档”既定分层（上游统一视图 → snapshot → 终表 → 覆盖率看板）推进审计，不另起炉灶：
	- 上游入口： `v_merchant_profile_latest_di` ；
	- 决策/快照： `store_tag_snapshot_di` ；
	- 终表与对外口径： `station_tag_target_value` ；
	- 证据与回溯： `tag_audit_log_di` 。
- 你只需要把“审计”固化为三张产出：
	1. `tag_coverage_by_tag` （覆盖率日报/周报）
	2. `tag_accuracy_scorecard` （准确率与错误分解）
	3. `tag_fix_runbook` （修复优先级与责任分工）

---

## 3）核心内容模块（可直接拿去对齐老板/评审）

### 3.1 商户画像项目定位（本次聚焦“标签质量审计”）

**项目目标（SMART）**

- S：覆盖率口径统一到 `station_tag_target_value` ，准确率可解释可复现。
- M：
	- 覆盖率：按 tag\_code 输出 *适用范围内* 的有效覆盖率（非兜底、QC 有意义）。
	- 准确率：对 P0/P1 标签实现分层抽样准确率评估，产出误差分解与修复闭环。
- A：基于现有 QC 字段与审计日志，无需新增重资产系统。
- R：与你的“双90/覆盖率统一口径”总控方向一致。
- T：建议以 2 周为一个审计迭代周期（Week1 覆盖率口径+报表，Week2 准确率抽样+闭环）。

**关键业务场景（优先级）**

1. 中台运营/智能补贴等强依赖标签的策略（高优先）
2. 画像类下游（分层运营、KA 分层）
3. 站点信息展示/质检（中优先）

---

### 3.2 数据与标签体系设计（审计口径怎么定义）

#### A. 覆盖率口径（强制统一）

**1）分母：适用范围（Applicable Scope）**

- 全量适用：如 `open_24h/open_hours/parking/restroom/...`（对所有 store 都有意义）
- 条件适用：如 `service_carwash_type` 仅对 `service_carwash_available=1` 的站适用（否则“无类型”并不算缺失）。

**2）分子：有效覆盖（Covered = 有意义且非兜底）**  
直接用终表 QC 做硬门槛（你们已经把字段准备好了）：

- `qc_value_has_meaning=1`
- `qc_is_fallback_value=0` （兜底不计入有效覆盖）
- `qc_is_wrong_cleaning=0` （错误清洗不计）
- 你们若坚持“原样不算纠偏”，可加 `qc_is_same_as_source=0` （这会更严，但要对齐业务解释）。

**3）兜底识别（必须可解释）**

- 枚举/布尔：以 `tag_enum.is_default=1 & is_active=1` 识别兜底枚举；
- 字符串：以 `tag_spec.fallback` 识别兜底。

#### B. 准确率口径（建议分三层：值准确、可用准确、决策准确）

- **值准确率（Value Accuracy）** ：预测值与金标值一致的比例（严格口径）。
- **可用准确率（Usability Accuracy）** ：允许业务等价类（例如“有/无”正确即可，不强求类型细分），用于对老板解释。
- **决策准确率（Decision Accuracy）** ：当候选冲突时 chosen\_level 是否合理（用 `tag_audit_log_di` 回溯）。

---

### 3.3 策略路径对比（至少两条可选方案）

#### 路径 A：轻量可落地（推荐先用）

**思路** ：覆盖率全量统计 + 准确率分层抽样（人审为主），2 周一个闭环。

- 优点：快、成本低、适合你作为 Owner 在审计节点交付。
- 缺点：准确率依赖抽样，不能覆盖所有 corner case。
- 适用前提： `visit_records_enriched` 或业务核验渠道能提供“足够金标样本”。

#### 路径 B：偏自动化（中期升级）

**思路** ：在抽样基础上，引入“自动一致性/反证规则”形成更高频监控：

- 例：
	- `open_24h=1` 则 `open_hours` 必须标准化为 `00:00-24:00` ；
	- `service_carwash_type` 只能在 `service_carwash_available=1` 时非空；
	- 枚举值必须存在于 `tag_enum` 的 active 集合。
- 优点：持续监控、能做门禁与告警。
- 缺点：需要补一层规则库/阈值配置治理（但你们已有 `tag_algo_config` 的方向）。

---

### 3.4 项目推进与协同（4周内可交付的节奏）

#### 最近 4 周拆解

- **W1：覆盖率口径固化 + 产出报表**
	- 明确每个 tag\_code 的适用范围（全量/条件适用）
	- 落地 `tag_coverage_by_tag` 、 `tag_coverage_overall`
	- 输出 Top N 覆盖短板标签与短板区域/品牌分布
- **W2：准确率抽样审计 V1**
	- 产出抽样框：按省区/品牌/门店等级/来源层级（STORE/MERCHANT/PARTY）分层
	- 金标采集：来自 `visit_records_enriched` 的 canonical record 或人工核验池（你们已有主记录/冲突标记能力）。
	- 输出：每个标签的准确率 + 错误类型分解
- **W3：修复闭环**
	- 针对错误类型，分别修：tag\_enum（枚举/默认）、tag\_name\_mapping（映射）、规则阈值、上游字段质量
	- 复跑 + 对比（Before/After）
- **W4：门禁与Runbook固化**
	- 建立红黄绿阈值与发布门禁
	- 固化“审计-修复-复验”的 Runbook（可回放）

#### 角色分工（建议）

- 数据（你/数据同学）：口径、SQL、抽样框、scorecard
- 产品：标签定义/适用范围评审、门禁阈值定义
- 运营/区域：金标核验与疑难样本复核（冲突样本优先）
- 算法/规则 Owner：阈值、推断策略修复（如有）

---

## 4）行动清单（必须可执行）

| 优先级 | 事项 | 责任人角色 | 时间 | 输出物 |
| --- | --- | --- | --- | --- |
| P0 | 固化覆盖率口径（适用范围/分子/兜底识别） | 数据+产品 | 本周 | 《覆盖率口径说明V1》+ 口径SQL模板 |
| P0 | 建 `tag_coverage_by_tag` / `tag_coverage_overall` | 数据 | 本周 | 覆盖率日报/周报视图 |
| P0 | 定义准确率抽样分层（省区/品牌/等级/来源层级） | 数据 | 下周 | 抽样框与样本清单 |
| P1 | 建金标采集流程（visit canonical + 人审表单） | 运营+数据 | 下周 | 金标样本表/清单 |
| P1 | 输出 `tag_accuracy_scorecard` （准确率+错误分解） | 数据 | 第2周末 | Scorecard V1 |
| P1 | 修复优先级排程（按影响下游/错误率/覆盖损失） | 产品+数据 | 第3周 | `tag_fix_runbook` V1 |
| P2 | 建一致性规则门禁（自动化校验） | 数据+产品 | 第4周 | 门禁规则集 + 告警阈值 |

---

## 5）风险与关键假设（观测指标 + 兜底方案）

**关键假设**

- 终表 `station_tag_target_value` 的 QC 字段已被稳定赋值（否则覆盖率口径会失真）。
- `visit_records_enriched` 的 `is_canonical_record` / `data_quality_flag` 可作为金标来源筛选依据（否则金标噪声过大）。

**主要风险与兜底**

1. **金标不足或质量差**
	- 观测：抽样后“冲突/无效样本占比”过高（data\_quality\_flag=conflict）。
	- 兜底：优先只用 `is_canonical_record=1` 的样本；必要时补“冲突样本复核池”。
2. **覆盖率被兜底“刷高”**
	- 观测： `qc_is_fallback_value=1` 占比异常上升。
	- 兜底：报表强制拆分“有效覆盖 vs 兜底覆盖”。
3. **错误不可解释导致修复困难**
	- 观测：高错标签缺少 trace 或候选信息。
	- 兜底：强制要求写 `tag_audit_log_di.trace_json` （没有证据链的不允许提审上线）。

---

## 6）思维导图结构（文本分层）

- 目标审计
	- 覆盖率
		- 适用范围（分母）
		- 有效覆盖（分子：非兜底+QC有意义）
		- 报表：by\_tag / overall / 分维度（省区/品牌/等级/来源）
	- 准确率
		- 金标来源：visit canonical / 人审
		- 抽样设计：分层抽样 + 冲突样本优先
		- 评估口径：值准确 / 可用准确 / 决策准确
		- 错误分解：枚举/映射/规则/上游质量
	- 闭环治理
		- 红黄绿门禁
		- 修复 Runbook
		- 复跑复验（Before/After）

---

## 7）迭代日志

- 来源：你提出“目标审计时刻，需要计算标签覆盖率和准确率，并以 Owner 身份提方案”。
- 本轮结论：给出一套以 `station_tag_target_value` 为唯一口径锚点的覆盖率/准确率审计方案，包含指标定义、抽样审计、证据回溯、组织协同与4周落地节奏。
- 改动点（相对你现状的提升）：
	- 将“覆盖率=有值”升级为“覆盖率=适用范围内有效覆盖（非兜底+QC）”；
	- 将“准确率=一个数字”升级为“准确率+错误分解+可解释证据链”。
- 待补充（你给我这三项，我可以把方案直接落成可执行 SQL/表结构与评审稿）：
	1. 你们定义的 **P0/P1 标签清单** （从 `tag_catalog` 的 is\_p0 或业务定义取）
	2. 目前 `station_tag_target_value` 的 **每日 as\_of\_date 刷新频率与可回溯天数**
	3. 哪些标签的金标可以直接来自 `visit_records_enriched` （哪些需要额外人工核验）
- 下一步建议：你如果要“直接拿去开评审会”，我建议你把评审结构定为：口径（5页）+ 当前基线（2页）+ 抽样方案（2页）+ 门禁阈值与排期（1页）。

我需要你协助我拆解这个需求；写成一个需求说明文档；我会让Claude来协助我来实现；我能提供必要的数据在哪里；

20251224\_1020\_标签质量审计\_需求说明文档\_PRD\_V1  
tags：#需求拆解 #覆盖率口径 #准确率抽样 #审计证据链 #交付与验收

---

## 1）一句话结论

把“标签覆盖率与准确率审计”产品化为一套 **可复跑的数据产出链路** ：输入为标签配置与终表快照/审计日志，输出为 **覆盖率报表、准确率记分卡、问题清单与修复Runbook** ；你只需要按本文档提供 **表清单+字段字典+样本数据/权限** ，即可让 Claude 按模块实现。

---

## 2）三段论据（现状与问题 → 关键洞察 → 路径方案）

### 论据一：现状与问题

- 你作为 Owner 的审计诉求不是“算两个指标”，而是要交付一套 **统一口径、可解释、可持续运行** 的质量体系：覆盖率要防“兜底刷高”，准确率要有“证据链+抽样方法+可复现”。
- 若没有明确的 **输入数据范围、表口径与验收标准** ，Claude 只能写出零散 SQL，无法形成可审计闭环。

### 论据二：关键洞察

- 覆盖率与准确率是两个层次：
	- 覆盖率更像“产能与可用性”（适用范围内是否产出非兜底有效值）；
	- 准确率更像“质量与可信度”（抽样对照金标，并能回溯为何如此取值）。
- 把这两件事拆成 **数据口径层、计算层、展示层、治理闭环层** ，实现难度可控且易于验收。

### 论据三：路径方案

- 需求文档按“模块化交付”定义：
	1. 覆盖率（全量统计，日/周报）
	2. 准确率（分层抽样 + 金标对照 + 错因分解）
	3. 证据链（trace/审计日志回溯，支持复盘）
	4. 闭环治理（红黄绿门禁 + 修复优先级 + Runbook）
- 数据提供方式给你三条路： **线上数仓直连、导出文件上传、本地DB同步** ；你按条件选其一即可推进。

---

## 3）需求说明文档（PRD）

### 3.1 背景与目标

**背景**

- 当前进入“目标审计”节点，需要向管理层/协同方证明：标签体系在“覆盖率（可用性）”与“准确率（可信度）”上达到预期，并能持续监控与迭代。

**目标（本期交付）**

1. 产出覆盖率：按 `tag_code` 、维度（省区/品牌/等级/来源层级等）输出“有效覆盖率”。
2. 产出准确率：对 P0/P1（或高影响）标签完成分层抽样审计，输出准确率与错误分解。
3. 治理闭环：形成 Top 问题标签清单、修复建议、复验机制与门禁阈值。

**非目标（本期不做）**

- 不在本期重建标签算法/重构全链路ETL；本期聚焦审计与度量体系（必要时输出“修复建议”即可）。

---

### 3.2 术语与口径定义（必须在评审前冻结）

**覆盖率（Coverage）**

- 分母：适用范围内的门店集合（Applicable Scope）。
- 分子：满足“有效值”条件的门店集合（Covered）。
- “有效值”建议硬条件：非空 + 非兜底 + QC 有意义（如有 QC 字段/规则）。
- 报表必须拆分展示：
	- 总覆盖率
	- 兜底覆盖率（fallback 覆盖）
	- 无值/异常占比

**准确率（Accuracy）**

- 抽样审计为主：分层抽样（区域/品牌/门店等级/来源层级/新老门店）。
- 金标（Ground Truth）来源：
	- 优先：业务核验/巡检数据/可置信主记录
	- 其次：人工核验（运营/区域复核）
- 输出两档口径：
	- 严格准确率（值完全一致）
	- 可用准确率（业务等价类一致，如“有/无正确即可”）

---

### 3.3 范围与模块拆解（给 Claude 的实现边界）

#### 模块 A：标签清单与适用范围

**输入**

- 标签配置表/文件：至少包含 `tag_code` 、tag 类型（枚举/数值/文本）、兜底定义、是否 P0/P1、适用条件（如 carwash\_type 依赖 carwash\_available=1）。  
	**输出**
- `dim_tag_scope` （或配置文件）：每个 tag 的适用范围逻辑（SQL 条件或规则表达式）。

#### 模块 B：覆盖率计算（全量）

**输入**

- 标签终表快照： `as_of_date/dt` 、 `store_id` 、 `tag_code` 、 `tag_value` （或 enum\_code/label）、以及 QC 字段（如有）。
- 门店维表：用于分维度统计（省区/品牌/等级/城市等）。  
	**输出**
- `tag_coverage_by_tag_day` ：按日、tag、维度统计分母/分子/兜底/无值/异常
- `tag_coverage_overall_day` ：整体口径
- Top 问题榜单：覆盖短板 tag、短板维度

#### 模块 C：准确率抽样与记分卡

**输入**

- 抽样框：可从门店全集按分层规则抽取（并记录抽样种子/策略以便复现）。
- 金标表： `store_id` 、 `tag_code` 、 `gold_value` 、 `gold_source` 、 `auditor` 、 `audit_time` 。  
	**输出**
- `tag_accuracy_scorecard` ：tag 维度的准确率、样本量、置信区间/稳定性指标（可选）、错误类型分解
- `tag_accuracy_error_cases` ：错误样本明细（用于修复）

#### 模块 D：证据链与可解释性

**输入**

- 审计日志/trace：能反查 “候选值→选择逻辑→最终值”。若暂时没有，至少要能拿到“来源层级/规则版本/字段来源”。  
	**输出**
- 错因分解报表：
	- 枚举缺失/默认值策略问题
	- 映射错误（tag\_name\_mapping）
	- 数据源字段异常/缺失
	- 规则阈值/优先级冲突

#### 模块 E：门禁与治理闭环

**输入**

- 覆盖率/准确率结果
- 业务优先级（哪些标签影响中台运营/补贴等）  
	**输出**
- `tag_quality_gate` ：红黄绿阈值（覆盖率、准确率、兜底占比、异常占比）
- `tag_fix_runbook` ：修复行动清单（责任角色、修复方式、复验方法、上线门禁）

---

### 3.4 数据需求清单（你需要“提供必要的数据在哪里”）

你可以用下面任意一种方式提供数据（推荐按可得性选择）：

#### 方式 1：直接给表访问（最省事）

你提供：库名、表名、字段字典、可查询权限（只读即可）、可回溯日期范围。  
Claude 实现时只需按表跑 SQL/导出结果。

#### 方式 2：导出文件上传（最稳妥）

你提供：CSV/Parquet/Excel/SQL dump（脱敏后），并附：字段说明与样例 50 行。  
建议文件：

- 标签配置：tag\_spec/tag\_enum/tag\_catalog（你已有对应文件亦可直接用）
- 标签终表快照： `as_of_date, store_id, tag_code, value, qc_*` （至少近 7/30 天）
- 门店维表： `store_id` 对应省区/品牌/等级/城市等
- 金标表：若没有可先空表，先跑覆盖率与抽样框

#### 方式 3：同步到本地DB（适合你已在本地跑链路）

你提供：本地 MySQL 库中可用的相关表（只要能 SELECT），以及关键表的 DDL/样本数据范围。  
如果你本地已有 `data_manager_db` 这类环境，直接把需要的表同步进来即可（只读/临时表也行）。

---

### 3.5 验收标准（Definition of Done）

**覆盖率**

- 能按日生成：整体 + 分 tag\_code + 分维度（至少省区/品牌）
- 口径固定：分母=适用范围；分子=有效值（非兜底、QC有意义）
- 结果可追溯：每个指标能下钻到 store 明细（抽查 10 条能解释）

**准确率**

- 抽样方法固定且可复现（分层规则 + 样本量 + 抽样记录）
- 记分卡产出：tag 维度准确率、样本量、错误分解
- 错误样本可下钻：至少能给出“预测值、金标值、证据字段/trace”

**治理闭环**

- 产出 Top 问题标签清单与修复建议
- 给出门禁阈值草案（红黄绿），并能在复跑后对比 Before/After

---

## 4）思维导图结构（文本分层）

- PRD：标签质量审计
	- 目标与范围
	- 口径定义
		- 覆盖率（适用范围/有效值/兜底拆分）
		- 准确率（抽样/金标/严格与可用口径）
	- 模块实现
		- A 标签清单与适用范围
		- B 覆盖率统计
		- C 准确率抽样与scorecard
		- D 证据链与错因分解
		- E 门禁与Runbook
	- 数据输入与提供方式
	- 验收标准与风险

---

## 5）迭代日志

- 来源：你提出“拆解需求、写需求说明文档，交给 Claude 实现，并明确我能提供必要数据在哪里”。
- 本轮结论：已给出可直接评审/分工/实现的 PRD 结构、模块拆解、数据清单与三种数据提供路径、验收标准。
- 改动点：把“算指标”升级为“可复跑的审计产品化交付（报表+抽样+证据链+门禁）”。
- 待补充（你不需要一次性都给，按优先级给前三项即可）：
	1. **标签终表快照** ：包含 tag\_value 与 qc 字段（近 7/30 天）
	2. **门店维表** ：store\_id 维度字段（省区/品牌/等级至少两项）
	3. **标签配置清单** ：tag\_code 是否 P0/P1、兜底定义、适用条件
	4. **金标来源** ：有没有现成巡检/核验表；如果没有，先给人工核验模板字段
- 下一步建议：你把上述(1)(2)(3)以“表名+字段+样本日期范围”的形式贴出来或导出上传，我就能把 PRD 进一步落到 **具体表结构/SQL接口/产出字段级定义** ，并同时给你一份“给 Claude 的实施任务拆解清单（逐条可勾选）”。