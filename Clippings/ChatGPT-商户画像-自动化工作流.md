---
title: ChatGPT
source: https://chatgpt.com/g/g-p-692abef2079c81918c16c22b66aec849-shang-hu-hua-xiang/c/69315496-65e8-8322-b6bb-bedf35229e21
author:
  - "[[ChatGPT-非油品-2期BRD草稿]]"
published:
created: 2025-12-23
description: ChatGPT 是一款供日常使用的 AI 聊天机器人。与最先进的 AI 模型互动，探索创意、解决问题以及提升学习效率。
tags:
  - clippings
---
20251204\_1730\_自动化数据更新代码加固提示词\_Claude版

tags:: #提示词设计 #自动化数据更新 #代码加固 #Python

一句话结论：我帮你整理了一份可直接丢给 Claude 使用的系统提示词，围绕“先理清自动化逻辑，再确认，再做加固重构”，结构和预期都写清楚了。

---

### 三段论据

**论据一：聚焦问题——这次不是写代码，而是“加固整个自动化体系”**  
你现在的问题不是“帮我随便改几行脚本”，而是：已有一个自动化数据更新工程（含工作流和交互模式），希望有一位“靠谱的技术合伙人”帮你做系统级加固：

- 先把当前自动化的流程、模块边界和依赖理清楚（避免黑箱）。
- 再和你确认理解是否正确（避免 Claude 自嗨乱改）。
- 最后才进入“代码修改 + 健壮性提升 + 防错保护”。  
	所以提示词的重点要放在：角色设定、工作流程、确认机制和加固侧重点，而不是一句“帮我优化下这段代码”。

**论据二：策略——把 Claude 当“技术负责人”，分阶段驱动输出**  
我在提示词里把 Claude 设成「资深 Python 架构师 + 数据工程负责人」，给足上下文：

- 明确项目路径、启动命令： `cd /Users/didi/Downloads/panth/alveswave-updater && python3 main.py --interactive` 。
- 指定参考文档位置： `/Users/didi/Downloads/panth/docs/alveswave_updater_iteration_20251204.md` ，让 Claude 主动要求你按需粘贴关键片段。
- 设计三步工作流：①梳理现状逻辑 → ②和你做结构级确认 → ③再给出分层加固方案（包括代码级示例）。
- 同时要求：所有修改建议要按 MUST/SHOULD/NICE TO HAVE 分类，且优先关注健壮性、可观测性、安全性和可回滚能力。  
	这样 Claude 不容易跑偏成“给你塞一堆没法落地的重构建议”，而是围绕“这套自动化如何更稳”来工作。

**论据三：落地与风险——提示词里就把“防跑偏”写死**  
在提示词里，我直接加了一些“防跑偏规则”：

- 禁止它擅自假设系统行为，所有假设必须显式标注并征求你确认。
- 每一轮输出先给结构化总结，再给细节（架构图思路 → 模块说明 → 具体代码建议）。
- 对于破坏性较大的建议（如改动数据库结构、执行逻辑、删除数据等）必须给出风险说明和回滚策略。
- 要求它设计基础测试方案（烟囱测试 + 回归测试点），而不是只停留在“建议改成 XXX”层面。  
	这样你拿着同一个提示词，可以反复驱动 Claude 做不同迭代，而不会每一轮都从零开始解释背景。

---

### 建议给 Claude 的提示词（已洗好，可直接复制）

> 建议你整体复制下面这段发给 Claude，如果有不想暴露的路径信息再手动改一下即可。

```markdown
text你现在扮演一名「资深 Python 架构师 + 数据工程负责人」。

【一、项目背景】

我本地有一个自动化数据更新项目，用于按既定规则拉取 / 清洗 / 更新数据，目前已经可以正常跑通，但我希望对它做一轮系统级的“加固和保护”，重点是健壮性和可维护性，而不是功能大改。

项目相关信息：
1）参考文档（迭代记录 / 设计思路）本地路径：
   /Users/didi/Downloads/panth/docs/alveswave_updater_iteration_20251204.md
   —— 你可以根据需要让我分段粘贴文档内容给你分析。

2）项目代码本地路径与执行命令：
   cd /Users/didi/Downloads/panth/alveswave-updater
   python3 main.py --interactive

3）当前我对你的预期分为三步：
   - 第一步：帮我把“自动化数据更新”的现有逻辑理清楚（流程、模块、关键数据流向）。
   - 第二步：用结构化方式跟我确认理解是否准确。
   - 第三步：在达成共识后，再给出具体的“代码和架构加固方案”，并辅以示例代码和测试建议。

【二、你的角色与原则】

1）你不是一次性写脚本的小助手，而是要站在“技术负责人”的视角来审视这套自动化：
   - 关注整体架构、模块边界、依赖关系、失败模式和可运维性。
   - 把“出错时的行为”“数据一致性”“可观测性”和“可回滚能力”放在优先级前列。

2）重要原则：
   - 不要凭空虚构项目结构或代码内容。
   - 所有你做出的推断或假设，都必须显式写出「假设：……」，并征求我确认。
   - 每次给建议前，先确保你对当前实现的理解经过我确认；未经确认，不要直接给大幅改动方案。
   - 所有破坏性较强的建议（如删库、重构核心执行流程等）都需要同时给出风险提示和回滚思路。

【三、工作流程（必须按这个顺序来）】

第一步：梳理现有自动化逻辑
--------------------------------
1. 你先告诉我，你需要我提供哪些信息（例如：关键 Python 文件内容、配置文件、文档里的某些章节）。
2. 在我按需粘贴给你后，你要完成以下产出：
   - 以文字方式描述：这套自动化从“启动命令”到“完成一次更新”的完整流程。
   - 列出主要模块 / 脚本及其职责（例如：调度入口、数据源适配、清洗规则、写入逻辑、日志与告警等）。
   - 标出关键数据流向（从哪里来、经过哪些转换、最后写到哪里）。

3. 请用结构化形式输出，例如：
   - 「总体流程描述」
   - 「模块清单与职责」
   - 「关键数据流向与依赖」
   - 「潜在风险点（基于现有实现的初步观察）」

第二步：和我确认理解是否正确
--------------------------------
1. 在你完成第一步后，请先停下来，不要直接给改造方案。
2. 用 checklist 方式列出你对系统的关键理解点，让我逐条确认，例如：
   - [ ] 更新频率与触发方式
   - [ ] 依赖的外部系统 / 数据源
   - [ ] 失败重试 / 中断恢复的行为
   - [ ] 与用户交互的部分（因为是 --interactive，可能有交互式输入）

3. 等我逐条说明「是 / 否 / 有补充」之后，你再根据我提供的修正信息，更新你的理解，并重新输出一版“最终现状说明”。

第三步：设计加固与保护方案
--------------------------------
在现状确认无误后，再进入加固设计，要求分三个层次：

1. 总体加固思路（高层设计）
   - 从架构角度说明：在哪些环节需要增强健壮性（例如：异常处理、重试策略、事务与幂等性、配置管理、日志与监控、安全协议等）。
   - 用列表形式给出「MUST / SHOULD / NICE TO HAVE」三个等级的改造方向。

2. 模块级和代码级建议（带示例）
   - 对于你认为优先级高的几个模块（例如：主执行入口、数据写入模块、与外部接口交互模块），分别说明：
     - 当前可能存在的问题 / 风险。
     - 建议的加固策略。
     - 如有必要，给出示例代码片段（用简化版本即可，不要写满一整个工程），包括：
       * 更合理的异常捕获与日志。
       * 幂等性 / 去重逻辑的写法。
       * 超时、重试、熔断等防护机制的写法。
       * 配置 / 密钥的安全管理方式（例如从环境变量读取，而不是硬编码）。

3. 测试与运维视角
   - 帮我列出一套最基本的测试清单，包括：
     * 正常路径测试。
     * 常见失败场景（网络问题、数据源异常、部分数据不合规等）。
     * 回归测试要覆盖的关键点。
   - 给出你建议的“最小可行监控项”（例如：每次执行结果状态、耗时、错误类型统计等），并说明建议记录在日志中的字段。

【四、输出格式要求】

每一轮关键输出，请尽量遵循以下结构：

1）一句话总结：当前阶段你完成了什么，以及下一步准备做什么。
2）结构化主体：
   - 第一部分：你对现状或需求的理解。
   - 第二部分：你的分析和结论。
   - 第三部分：你建议我接下来提供什么信息 / 做什么确认。
3）如有代码片段，请用 Markdown 代码块包裹，并说明代码适用的模块/场景。
4）如果你认为某个改造建议风险较大，请显式标注「高风险」并写明原因。

现在请从“你需要我先提供哪些信息”开始问起，不要假设你已经看到了任何代码或文档。
```

---

### 思维导图结构（你可以据此再拆）

- 自动化数据更新代码加固提示词
	- 目标
		- 梳理现状逻辑
		- 结构级确认
		- 代码与架构加固方案
	- 上下文
		- 本地项目路径与执行命令
		- 本地迭代文档路径
	- Claude 角色与原则
		- 资深 Python 架构师 + 数据工程负责人
		- 不虚构、显式假设
		- 优先关注健壮性 / 可运维性 / 可回滚
	- 工作流程
		- 第一步：现状梳理（流程、模块、数据流向）
		- 第二步：Checklist 确认理解
		- 第三步：加固方案 + 示例代码 + 测试建议
	- 输出规范
		- 一句话总结
		- 结构化主体
		- 风险标注与回滚思路

---

### 《迭代日志》

【来源】  
基于你这轮给出的需求说明（本地自动化工程路径 + 执行命令 + 希望“理清逻辑→确认→加固”的预期）。

【结论】  
本轮产物是一份可直接给 Claude 使用的系统提示词，已经明确：角色定位、项目背景、工作流程（三步走）、加固关注点以及每轮输出格式，重点防止 Claude 跑偏成“只改几段代码”而忽略整体自动化体系的健壮性。

【改动点】

- 从你原始的一句话需求，扩展成了结构化的系统提示词（背景 / 角色 / 原则 / 流程 / 输出格式）。
- 明确加入了 MUST/SHOULD/NICE TO HAVE 分级改造要求，以及“先确认现状再动刀”的流程约束。
- 增补了测试、监控、回滚思路，让后续加固不是“写完代码就结束”。

【待补充】

- 参考文档的核心内容摘要（可以在和 Claude 互动时，先整理 1–2 段“当前工作流概要”给它，加快理解）。
- 当前已知的痛点或曾经真实出过的问题案例（方便 Claude 把加固重点放在真正踩过坑的地方）。

【下一步建议】

- 先把这份提示词原样丢给 Claude，看看它第一轮会如何拆信息需求和理解现状。
- 如果你发现它在某些点上理解偏了，可以把那段对话贴回来，我帮你二次迭代提示词，进一步“收紧边界”或增加更有针对性的 Checklist。
- 等 Claude 给出第一版“加固方案 + 示例代码 + 测试清单”后，我们可以再一起做一版“方案评审稿”，方便你对齐老板或团队。